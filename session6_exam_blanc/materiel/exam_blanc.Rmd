---
title: "Exam blanc"
output:
  html_document:
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br>

# Consignes générales

<br>

**Ouvrez _exam_blanc.Rmd_ et sauvez le dans le dossier _session6_exam_blanc_ en y ajoutant votre nom.** 

**Pour chaque question:**

**- Expliquez ce que vous allez faire et pourquoi vous utilisez telle ou telle fonction.**

**- Ajoutez des zones de code de Rmarkdown pour répondre à la question à l'aide de commandes.**

**- Et finalement répondez à la question grâce au résultat des commandes.**

<br>

# Description des données

Aujourd'hui, vous allez analyser des données extraites de [Cortijo et al., 2017](https://www.sciencedirect.com/science/article/pii/S1674205217302459?via%3Dihub). 

Il s'agit de données issues d'expériences pour mesurer l'expression des gènes en réponse à la chaleur chez *Arabidopsis thaliana*. Pour cela des plantes ont été mises à pousser à 17°C et ont ensuite été transférées à 17°C (contrôle), à 27°C (chaleur) et à 37°C (stress chaleur). 

Afin de suivre la dynamique d'expression en réponse à chaque traitement, les plantes ont été collectées aux temps zero (moment du transfert) et après 15min, 1 heure et 4 heures à chaque traitement. 
Voir le schéma ci-dessous indiquant le plan expérimental (Fig S1a de l'article)

![](images/Cortijo_2017_figS1a.png)


Pour chaque échantillon, l'expression pour l'ensemble des gènes d'*Arabidopsis thaliana* a été mesurée (un peu moins de 30000 gènes). Ensuite seuls les **1035 gènes** qui changent d'expression en réponse à la chaleur ont été conservés. C'est sur ces gènes que vous allez travailler.

<br>

Nous sommes intéressés en particulier aux changements d'expression en réponse à la température et au cours du temps pour ces gènes. Afin de s'affranchir des niveaux d'expression différents entre les gènes (certains sont fortement ou faiblement exprimé peu importe la réponse à la température), et de se concentrer sur la réponse à la température les données ont été transformé avec la formule suivante:

$$
log_2(\frac{\text{expréssion à la température et temps étudiés}}{\text{expression au temps  zéro}})
$$

Cette transformation des données est couramment utilisée dans ce domaine d'étude pour étudier la réponse de l'expression des gènes à un stimulus.

Les valeurs obtenues sont centrées autour de zéro. Pour chaque gènes:

- Les **valeurs positives** indiquent une expression à la température et temps étudiés **supérieure** à celle au temps zéro

- Les **valeurs négatives** indiquent une expression à la température et temps étudiés **inférieure** à celle au temps zéro

<br>

Pour aller plus loin, les auteurs ont regroupés ensemble les gènes qui ont des profils d'expression similaires au cours du temps. Par exemple tous les gènes qui ont une augmentation qui monte avec le temps en réponse à la chaleur ont été regroupé ensemble. De cette manières ils ont identtifié **7 groupes**, appelés **clusters**.

<br>

Les données sur lesquelles vous aller travailler sont dans le tableur _data_expression_cortijo2017.txt_ qui contient **une ligne pour chacun des 1035 gènes**, et **une colonne pour chaque condition**: 

- 15 minutes à 17°C

- 1 heure à 17°C

- 4 heures à 17°C

- 15 minutes à 27°C

- 1 heure à 27°C

- 4 heures à 27°C

De plus **une colonne indique à quel cluster appartient chague gène**.


# Préparation de l'environnement de travail



Préparez votre environnement de travail:

> Chargez les librairies dont vous aurez besoin. 


> Chargez le fichier _data_expression_cortijo2017.txt_ (qui est dans le dossier _session6_exam_blanc/data_) dans R et sauvez le dans un objet
*Aide*: Utilisez la fonction appropriée pour le type de données (dans ce cas colonnes séparées par une tabulation)


# Vérification des données

### Question 1


Avant d'analyser les données, la première étape consiste à vérifier que le tableau importé dans _R_ contient bien les données attendues.

> Est-ce que le tableau importé dans R contient le bon nombre de gènes?
>
> Est-ce que le tableau importé dans R contient les données d'expression dans les 6 conditions (15 minutes à 17°C, 1 heure à 17°C, 4 heures à 17°C, 15 minutes à 27°C, 1 heure à 27°C et 4 heures à 27°C) ainsi que l'information pour le cluster d'appartenance de chaque gène? 

<br>

### Question 2

> Est-ce que les différentes variables (les colonnes) sont bien du type attendu? 

<br>

### Question 3

> Est-ce que le tableau importé dans R contient bien le nombre de clusters attendus?
> Quels sont leurs noms?

<br>

### Question 4

Avant de faire cette expérience à grande échelle, les chercheurs ont étudié quelques gènes en particulier. Avant d'aller plus loin dans l'analyse, une dernière vérification consiste à s'assurer que ces gènes se comportent comme attendu dans notre jeu de données.

Ces gènes sont:

- **AT1G04520**: Les chercheurs ont préalablement observé que l'expression de ce gène diminue au cours du temps à 17°C et 27°C et que cette diminution est plus rapide est plus importante à 27°C.


- **AT3G12580**: Les chercheurs ont préalablement observé que l'expression de AT3G12580 augmente à 27°C de manière rapide et atteint son pic d'expression en 15 minutes avant de redescendre.


> Faites un graphique montrant l'évolution au cours du temps de l'expression de ces deux gènes à 17°C et 27°C. Obtenez vous des comportement d'expression correspondants aux résultats préliminaires effectués sur ces deux gènes?
>
>
> *Note*: Gardez en tête que le temps zéro n'est pas représenté sur le graphique, mais que compte tenu de la méthode de normalisation la valeur au temps zéro est de 0 pour tous les gènes.
>

*Aide: Pour effectuez ce graphique, filtrez tout d'abord les données pour garder les deux gènes d'intérêt, changez le format du tableau pour passer un format long avec une colonne contenant la condition experimentale et une colonne contenant les valeurs d'expression. Ensuite séparez la colonne avec les conditions expérimentales afin que la température et le temps du traitement soient dans deux colonnes différentes. Vous pouvez maintenant faire un graphique de type ligne représentant l'expression au cours du temps en regroupant les données par température avec un facet par gène.*


<br>


# Analyse de l'expression des gènes

Nous pouvons maintenant faire l'analyse à proprement parler des données. Chaque cluster représentant un type de réponse différente, nous allons les analyser plus en détail. 


### Question 5

> Combien de gènes y a-t-il dans chaque cluster?
>


### Question 6

> Faites un graphique permettant de connaitre la distribution de l'expression des gènes de chaque cluster au cours du temps pour les deux température.
> 
> Faite une version du graphique avec des violin plots et une autre avec des boxplot. 


*Aide: Pour effectuez ces graphique, changez le format du tableau pour passer un format long avec une colonne contenant la condition experimentale et une colonne contenant les valeurs d'expression. Ensuite séparez la colonne avec les conditions expérimentales afin que la température et le temps du traitement soient dans deux colonnes différentes. Vous pouvez maintenant faire un graphique de type violin plot ou boxplot représentant l'expression au cours du temps en colorant les données par température avec un facet par cluster.*


<br>


Les boxplot et violin plots sont deux types de graphique permettant de montrer des distributions.

> Expliquez ce que chacun de ces types de graphique représente. Quelles sont les différences entre boxplot et violin plot? 
>



<br>


> A partir des graphiques violin et boxplot des données, indiquez quels sont les clusters dont l'expression des gènes augmente, ou au contraire diminue, en réponde à la température.
>

<br>


Les chercheurs sont plus intéressé par le cluster 1 (qui contient AT1G04520) et le cluster 6A (qui contient AT3G12580).

> A partir de vos graphiques décrivez la réponse à la température au cours du temps de l'expression des gènes des clusters 1 et 6A 



### Question 7

Afin de s'assurer que le travail soit reproductible, toutes les informations necessaires doivent être inclus dans les graphiques.

> Pensez vous que les boxplot et violin plot crées dans la question 6 contiennent les informations necessaires? 
> Quelles informations ajouteriez vous pour vous assurer que le travail soit reproductible? (pas besoin de changer le graphique)


# Analyse de la fonction des gènes

### Question 8

Maintenant que nous connaissons la réponse de l'expression des gènes à la température, nous souhaitons en savoir plus sur leur fonction.

Malheureusement la table contenant les données d'expression ne contient que l'*AGI* des gènes qui est un identifiant unique pour chaque gène d'*Arabidopsis thaliana*, mais ne nous donne aucune information sur sa fonction.


L'information sur la fonction des gènes se trouve dans la table _gene_fonction_cortijo2017.txt_

> Chargez la table _gene_fonction_cortijo2017.txt_ dans R.
>
> Puis combinez la avec la table contenant l'expression des gènes ( _data_expression_cortijo2017.txt_ chargée en début d'examen) de manière à rajouter l'information sur la fonction des gènes à la table contenant l'expression des gènes et le cluster d'appartenance de chaque gène
>

<br>


Parmis les gènes étudiés plus en détail, **AT3G12580** est interessant car son expression augmente rapidement en réponse au traitement à 27°C. 

> A partir de la nouvelle table combinée, trouvez le nom de AT3G12580. Quelle fonction ce nom suggère t-il pour AT3G12580 en réponse à la chaleur?

<br>

AT3G12580 fait parti du cluster 6A.

> Filtrez la table combinée pour ne garder que le cluster 6A et affichez cette selection dans Rmarkdown.
>
> Combien de gènes dans le cluster 6A contiennent le mot "heat" dans leur nom? 
>
> Faites la même chose pour la table contennant tous les gènes. Combien de gènes dans la table complète contiennent le "heat" dans leur nom? 
>
> Qu'est ce que le nombre de gènes contenant le mot "heat" dans leur nom dans le cluster 6A par rapport à la table entière indique-t-il?



*Aide: Si vous créez le html de votre fichier Rmarkdown, vous pouvez filtrer les données dans le tableau créé pour compter le nombre de gènes contenant "heat" dans leur nom.*





******

<br>

## FIN DE L'EXAMEN BLANC




