---
title: "Exam blanc"
output:
  html_document:
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

[Retour à la page d'accueil](https://scortijo.github.io/2021_L3_R/)

<br>

## Consignes générales


A chaque fois expliquez ce que vous allez faire et pourquoi vous utilisez telle ou telle fonction.

Utilisez les zones de code de Rmarkdown pour répondre à la question.

Et finalement répondez à la question grâce au résultat de la ligne de code.


## Description des données

Aujourd'hui, vous allez analyser des données extraites de [Cortijo et al., 2017](https://www.sciencedirect.com/science/article/pii/S1674205217302459?via%3Dihub). 

Il s'agit de données issues d'expériences pour mesurer l'expression des gènes en réponse à la chaleur chez *Arabidopsis thaliana*. Pour cela des plantes ont été mises à pousser à 17°C et ont ensuite été transférées à 17°C (contrôle), à 27°C (chaleur) et à 37°C (stress chaleur). 

Afin de suivre la dynamique d'expression en réponse à chaque traitement, les plantes ont été collectées aux temps zero (moment du transfert) et après 15min, 1 heure et 4 heures à chaque traitement. 
Voir le schéma ci-dessous indiquant le plan expérimental (Fig S1a de l'article)

![](images/Cortijo_2017_figS1a.png)


Pour chaque échantillon, l'expression pour l'ensemble des gènes d'*Arabidopsis thaliana* a été mesurée (un peu moins de 30000 gènes). Ensuite seuls les **1035 gènes** qui changent d'expression en réponse à la chaleur ont été conservés. C'est sur ces gènes que vous allez travailler.

<br>

Nous sommes intéressés en particulier aux changements d'expression en réponse à la température et au cours du temps pour ces gènes. Afin de s'affranchir des niveaux d'expression différents entre les gènes (certains sont fortement ou faiblement exprimé peu importe la réponse à la température), et de se concentrer sur la réponse à la température les données ont été transformé avec la formule suivante:

$$
log_2(\frac{\text{expréssion à la température et temps étudiés}}{\text{expression au temps  zéro}})
$$

Cette transformation des données est couramment utilisée dans ce domaine d'étude pour étudier la réponse de l'expression des gènes à un stimulus.

Les valeurs obtenues sont centrées autour de zéro. Pour chaque gènes:

- Les **valeurs positives** indiquent une expression à la température et temps étudiés **supérieure** à celle au temps zéro

- Les **valeurs négatives** indiquent une expression à la température et temps étudiés **inférieure** à celle au temps zéro

<br>

Pour aller plus loin, les auteurs ont regroupés ensemble les gènes qui ont des profils d'expression similaires au cours du temps. Par exemple tous les gènes qui ont une augmentation qui monte avec le temps en réponse à la chaleur ont été regroupé ensemble. De cette manières ils ont identtifié 7 groupes, appelés **clusters**.

<br>

Les données sur lesquelles vous aller travailler sont dans le tableur _data_expression_cortijo2017.txt_ qui contient **une ligne pour chacun des 1035 gènes**, et **une colonne pour chaque condition**: 

- 15 minutes à 17°C

- 1 heure à 17°C

- 4 heures à 17°C

- 15 minutes à 27°C

- 1 heure à 27°C

- 4 heures à 27°C

De plus **une colonne indique à quel cluster appartient chague gène**.


## Préparation de l'environnement de travail

Pour commencer, créez un nouveau _fichier Rmarkdown_ et sauvez le dans le dossier _session6_exam_blanc_. Préparez votre environnement de travail:

- Chargez les librairies dont vous aurez besoin. 


- Chargez le fichier _data_expression_cortijo2017.txt_ dans R et sauvez le dans un objet
*Aide*: Utilisez la fonction appropriée pour le type de données (dans ce cas colonnes séparées par une tabulation)


## Vérification des données


Nombre de gènes
Type de variables dans chaque colonne. Est-ce ce à quoi on s'attend?
Nombre et nom de clusters


Profile pour 2 gènes controls (pour lesquels nous connaissons les profils d'expression grâce à des expériences préalables)



## Analyse de l'expression des gènes

Nombre de gènes par cluster

violin plots pour clusters aux différents temps. Tester 2 graphs différents: un avec température séparé par couleur, l'autre avec facets pour séparer les températures



## Analyse de facteurs régulant d'expression des gènes


Combien de gènes (du total) sont régulés par HSFA1a

Combien de gènes dans chaque cluster? Qu'est ce qu'on peut en conclure par rapport à la fonction de HSFA1a?











