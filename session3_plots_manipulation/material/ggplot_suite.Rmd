---
title: "Réaliser des graphiques - suite"
output:
  html_document:
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

[Retour à la page d'accueil](https://scortijo.github.io/2021_L3_R/)


Dans cette seconde partie de la section dédiée à la vidualisation de données vous allez:
- Changer l'apparence des graphiques 
- Combiner plusieurs graphiques dans une même figure
- Inclure du dynamisme et de l'interactivité à vos graphique
- Apprendre les meilleures pratique pour visualiser des données


# Mise en place

Avant de rentrer dans le vif du sujet il nous faut mettre en place notre environnement de travail. Créez un nouveau script R et:

- chargez les librairies nécessaires:

```{r load packages, eval = TRUE, message = FALSE}
library(tidyverse)
library(visdat)
library(plotly)
```

- changer votre répertoire de travail pour être dans le dossier `session3_plots_manipulation`:


``` {r}
setwd("~/Desktop/2021_L3_R/session3_plots_manipulation/")
```

- Importez les données dans R:

```{r read data}
expt1 <- read_tsv("../data/burghardt_et_al_2015_expt1.txt")
```

Nous sommes maintenant prêt!


# Changer l'apparence d'un graphique en utilisant les themes

Tous les élépments d'un ggplot sont modifiables. Les **themes** permettent de modifier l'apparence du graphique. Voici quelques exemples. 



```{r}
# Example de thèmes existants dans ggplot2 
ggplot(expt1, aes(genotype, days.to.flower)) +
  geom_boxplot() +
  theme_bw() +
  labs(title = "Black and white theme")

ggplot(expt1, aes(genotype, days.to.flower)) +
  geom_boxplot() +
  theme_classic() +
  labs(title = "Classic theme")

ggplot(expt1, aes(genotype, days.to.flower)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title = "Minimal theme")
```


La fonction `theme()` peut être utilisée pour modifier des éléments en particulier du graphique. Il y a tellement de possibilités que le mieux est de rechercher sur internet la modification que vous voulez faire.  


Par exemple, en recherchant "vertical labels x axis ggplot2" nous obtenons [cette solution](https://stackoverflow.com/questions/1330989/rotating-and-spacing-axis-labels-in-ggplot2): 

```{r}
ggplot(expt1, aes(genotype, days.to.flower)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

Rechercher "altering plot colours ggplot2" donne 
[ceci](http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually), qui apporte cette solution:

```{r}
ggplot(expt1, aes(genotype, days.to.flower, fill = fluctuation)) +
  geom_boxplot() +
  scale_fill_brewer(palette="Dark2")
```


# Combiner plusieurs graphiques dans une même figure

Parfois nous voulons crée une figure contenant plusieurs graphiques, c'est le cas dans la plupart des articles scientifiques


# Interactivité!

Pour aller plus loin, il est même possible de créer des graphiques intéractifs en utilsant le package `plotly`.  

Il faut d'abord mettre le graphique dans un objet, puis d'utiliser cet objet dans la fonction `ggplotly()`.


```{r go interactive}
# Mettre le graphique dans l'objet p1
p1 <- ggplot(expt1, aes(blade.length.mm, rosette.leaf.num, colour = fluctuation)) + 
  geom_point() +
  facet_wrap(~genotype)

# Utiliser la fonction ggplotly pour faire un graphique intéractif
ggplotly(p1)
```



# Extras

- [`gridExtra`](https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html) 
ou [`patchwork`](https://github.com/thomasp85/patchwork) 
pour combiner des graphiques ensemble
- [`ggthemes`](https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html) 
pour ajouter des thèmes et géométries en plus
